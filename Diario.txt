

1) Búsqueda de datasets y clasificación de los mismos en un documento.

	El utilizado previamente era WESAD

	Los datasets que parecen más útiles para nuestro trabajo son:
		
		K-EmoCon:
			https://www.nature.com/articles/s41597-020-00630-y#Sec17
			https://zenodo.org/record/3931963


		IoBT-VISTEC:
			https://github.com/IoBT-VISTEC/EEG-Emotion-Recognition-INTERFACES-datasets	


2) Programar aplicación para obtener nuestro propio dataset de muestras.

	La aplicación muestra las imágenes del dataset, para recoger los datos
	fisiológicos que puede recoger la pulsera que produce cada una de estas
	en el espectador.
	
	Entre ellas se intercala una imagen o video "neutro" aún por determinar
	con el fin de que se normalice el estado del espectador entre una imágen y otra.
	Por defecto será una imagen en negro.

	Antes de comenzar con la muestra de las imágenes también se muestra un video neutro
	con el mismo fin.



3) El video del que se habla en el artículo, color bars, no se ha podido obtener. 

	En su lugar, se ha encotrado el dataset LATEMO-E, con videos extraídos de diferentes películas junto a las emociones
	que provocan y arousal/valence. Algunos de estos son para una emoción neutra, podría servir de sustituto.

	LATEMO-E:
		https://www.scielo.br/scielo.php?script=sci_arttext&pid=S2358-18832019000200473
		https://figshare.com/articles/dataset/LATEMO_A_film_database_to_eliciting_discrete_emotions_and_evaluating_emotional_dimensions_for_Latin-Americans/5372782/1



4) El dataset de imágenes elegido, OASIS, contenía imágenes de una resolución muy baja, por lo que se ha decidido
sustituirlo por el dataset IAPS.

	IAPS:
		http://scielo.isciii.es/scielo.php?script=sci_arttext&pid=S0212-97282013000300036

	IAPS en un dataset privado que ya hemos obtenido.
	
	Parece que también tiene valoraciones específicas para españoles. Debemos buscar estos valores de valence/arousal
	en lugar de utilizar los americanos para un mejor funcionamiento.


5) Hemos cambiado de nuevo el dataset de imágenes a utilizar, ya que se ha encontrado el proyecto EmoMadrid de la Universidad Autónoma de Madrid.
Las imágenes se ven correctamente ya que su resolución es de 1024x768, y los datos han sido obtenidos con participantes de nacionalidad española.
Además, podremos seguir el mismo procedimiento con sus tiempos que tienen indicado en la web.
El dataset es privado y se ha tenido que pedir acceso.

	EmoMadrid:
		Español: http://www.psicologiauam.es/CEACO/EmoMadridEsp.htm
		Inglés: http://www.psicologiauam.es/CEACO/EmoMadrid.htm


6) Tras ciertas complicaciones, se ha conseguido cambiar la aplicación para reproducir un video antes de comenzar a mostrar las imágenes.

	El video se reproduce para captar el estado normal del participante y comenzar las imágenes desde ese estado inicial.
	Por tanto, el video debe inducir ese estado.
	Por ahora, el video que se muestra es "La Vie d'Adele (VDA).mp4" del dataset LATEMO-E, que según el estudio produce un estado neutro.


7) Cambios efectuados en aplicación

	Para que sea lo más similar a la manera en la que se asignaron sus valores a las imágenes:
		
		- Se muestra un total de 150 imágenes.
		- Entre las imágenes lo que se muestra es una pantalla en blanco (en el centro se muestra el número de imagen).
		- Cada imagen se muestra 1 segundo, el tiempo entre imágenes es 4 segundos.
		- Cada 25 imágenes se realiza un descanso de 15 segundos (Pantalla en blanco. Escrito en el centro: "Descanso (15 segundos)" ).
		
	Adicional:
	
		- Las imágenes son reescaladas para ocupar el tamaño de la ventana (se mantiene la relación de aspecto).


8) Cambios en la aplicación:
	
	- Ya no se muestra el número entre las imágenes. Únicamente la pantalla en blanco.
	- Se mantiene el mensaje para los descansos.
	- Se guarda el timestamp en el que es mostrado cada imagen en el fichero "timestamps.txt".
		Se utiliza el siguiente formato:
			<ruta imagen> HH:mm.ss


9) La aplicación para obtener las muestras con ayuda de la pulsera está acabada. Ya solo queda decidir la secuencia de imágenes a mostrar.
Que aún desconocemos a que atenernos para evitar fallos como el efecto halo.


10) He recibido la pulsera Empatica E4. 
	Necesito crear los datasets relacionando los timestamps de las imágenes mostradas al participante con los datos fisiológicos recogidos
	por la pulsera. Realizaremos un programa que nos genere los archivos automáticamente.

	Problema:
		Los datos en fichero csv que genera la pulsera no traen timestamp por cada muestra, solo uno que indica el inicio de la sesión.

	Primero hay que tratar estos datos, para asignar a cada muestra su timestamp. Hay una plantilla de excel en el apartado de support de la
	página oficial de la Empatica E4 que indica como realizar esto. No es complicado, pero sería muy laborioso hacerlo para todos los ficheros
	de todos los participantes.

	Solución 1:
	Por lo que en una primera fase del programa para generar los datasets crearemos estos datos ya procesados
	mediante el código; y una vez tengamos estos será cuando elaboremos los datasets emparejandolos con los tiempos de las imágenes.

	Solución 2:
	Después de leer el timestamp de una imagen, a partir de del timestamp inicial y de la frecuencia de muestreo calcular la línea inicial
	y final de muestras a obtener.
	
	La segunda opción sería más rápida, ya que con la opción 1 tendríamos que ir leyendo timestamps uno a uno hasta obtener los deseados.

	Así que la opción 2 será la que implementaré en un principio.

	Datos ofrecidos por la pulera:

		Cada uno de los archivos .csv:
			Timestamp inicio de sesión
			Frecuencia de muestreo (Hz)
			Valor 1
			Valor 2
			...
			Valor n

	Fase 1 (opcional, solo si aplicamos la solución 1) Datos de la pulsera procesados:

		Cada uno de los archivos .csv:
			Timestamp inicio de sesión
			Frecuencia de toma de muestras (Hz)
			Valor 1; timestamp 1
			Valor 2; timestamp 2
			...
			Valor n; timestamp n

	Resultado del programa:

		Carpeta usuario 1:

			eda_1_1.csv //muestras de eda registradas del usuario 1 viendo la imagen 1
			eda_1_2.csv //muestras de eda registradas del usuario 1 viendo la imagen 2
			hr_1_1.csv //muestras de hr registradas del usuario 1 viendo la imagen 1
			hr_1_2.csv //muestras de hr registradas del usuario 1 viendo la imagen 2
			...
		
			Cada fichero csv:
				
				Valor 1; timestamp 1
				Valor 2; timestamp 2
				...
			
11) Diseño final.
	- No se realiza el paso intemedio. El dataset final se obtiene calculando, con el timestamp del inicio de la sesión y el de
	cuando se ha visualizado la imagen, qué líneas del fichero csv contienen las muestras correspondientes  		

	La fórmula con la que se obtiene esto es la siguiente: linea = (t_image - t_inicio) * sample_rate

	Para todos los cálculos tener en cuenta que los timestamps se expresan en milisegundos, por tanto, si el sample_rate está en
	segundos como era nuestro caso, se debe multiplicar por 1000 antes de las operaciones.
	También tenerlo en cuenta cuando queremos asignar el rango de tiempo en el que se seleccionan las muestras. Debemos sumarle o
	restarle segundos*1000.


	La estructura final queda así:

	El directorio Data es en la que dispondremos los datos de las sesiones. Cada sesión en un directorio diferente llamado por un número,
	en orden desde 1 hasta la sesión última. En el driectorio de cada sesión también disponemos el fichero timestamps.txt generado por el
	programa que presentaba las imágenes al participante.


	Data
            |----1
            |     |----timestamps.txt
            |     |----EDA.csv
            |     |----ACC.csv
            |     [...]
       	    |
            |----2
                  |----timestamps.txt
                  |----EDA.csv
                  |----ACC.csv
                  [...]


	El resultado es el directorio generado Dataset. Sigue la misma estructura que Data, pero en lugar de estar los ficheros directamente
	en el directorio de cada sesión, cada tipo de dato tiene su directorio específico en el que se licalizarán los ficheros csv. Un fichero
	por imagen, denominado por ejemplo para el dato EDA: EDA_<num_sesión>_<num_imagen>.


	Dataset
            |----1
            |     |----EDA_1
            |     |        |----EDA_1_1.csv
            |     |        |----EDA_1_2.csv
            |     |        [...]
            |     |
            |     |----ACC_1
            |     |        |----ACC_1_1.csv
            |     |        |----ACC_1_2.csv
            |     |        [...]
            |     [...]
            |
            |----2
                 |----EDA_2
                 |        |----EDA_2_1.csv
                 |        |----EDA_2_2.csv
                 |        [...]
                 |
                 |----ACC_2
                 |        |----ACC_2_1.csv
                 |        |----ACC_2_2.csv
                 |        [...]
                 [...]


	
		
